<script setup>
import { reactive, ref, onMounted } from "vue";
import { getAssetsFile } from "@/util/utils.js";
import { useRouter } from "vue-router";
import { Edit } from "@element-plus/icons-vue";
import { getCourseList,getCourseFileList,getSCByStudentId } from "@/api/index";
import JSZip from 'jszip'
import {ElMessage} from 'element-plus'
import { addSC } from "@/api/index.js";
import { useUserStore } from '@/store/user'

const router = useRouter();
const store = useUserStore()

const handleGoDetail = (item) => {
  router.push({ name: "CourseDetail" });
  sessionStorage.setItem("courseInfo", JSON.stringify(item));
};

const params = {
  "pageParam": {
    "pageNum": 1,
    "pageSize": 100,
  },
}


const selectedCourseId = ref([])
const getScStudentId = async()=>{
  const {data,code } = await getSCByStudentId({studentId:store.info.userId})
  selectedCourseId.value = data.map(i=>i.scCourseId)
 }

const init = async()=>{
  await getScStudentId()
    const {code,data } = await getCourseList(params)
    courseInfo.value = data.list
    courseInfo.value = courseInfo.value.filter(item=>selectedCourseId.value.includes(item.courseId))
}

onMounted(() => {
  // try{
    init()
   
}) 


const courseInfo = ref([
  {
    cover: "img/编程导论.jpeg",
    name: "计算机编程导论",
    teacher: "张伟",
    timeSpan: "8周",
    studentNum: 50,
  },
  
]);

const handleAddCourse = () => {
  router.push('/course/create-course')
}

const chooseCourse = async(info)=>{
  // try{
    const params = {
      scCourseId: info.courseId,
      scStudentId: store.info.userId
    }
    const { code } = await addSC(params)
    if(code == 0){
      ElMessage.success('选课成功！')
      init()

    }else{
      ElMessage.error('选课失败！')
    }
  // }catch(e){
  //   ElMessage.error(e)
  // }
}
</script>

<template>
  <div class="course-list-wrap">
   <div class="mb-4" style="font-size: 18px;color: #409eff">我的课程</div>
    <div class="course-list">
    <div
      class="course-card"
      v-for="info in courseInfo"
      :key="info"
    >
      <div class="course-text-info">
        <div class="course-name">课程名：{{ info.courseName }}</div>
        <div class="course-teacher mb-4">教师名：{{ info.teacherName }}</div>
        <div class="course-info-item">{{ `课程开始时间:${info.courseStartTime}` }}</div>
        <div class="course-info-item">{{ `课程结束时间:${info.courseEndTime}` }}</div>
        <div class="course-info"> 
          <div class="course-info-right" style="color:#eca565;font-size: 14px;font-weight: 600;">{{ `${info.freeType == 0 ? '免费' : '付费'}` }}</div>
        </div>
        <div class="course-operation flex justify-end mt-2 items-center">
            <el-button type="primary" size="small" @click="handleGoDetail(info)">进入课程</el-button>
          </div>
      </div>
      <svg t="1715593983999"  class="course-card-bg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10271" width="200" height="200"><path d="M373.893171 608.768h284.672v16.896H373.893171zM373.893171 645.632h284.672v16.896H373.893171zM412.805171 686.08h206.336v12.288H412.805171zM615.045171 305.664H409.221171L512.133171 190.976zM735.365171 942.592c-26.624-18.944-50.176-11.264-57.856-8.704-1.536 0.512-2.56 2.56-2.048 4.608 1.536 9.728 8.192 36.864 35.328 54.784 26.624 18.944 50.176 11.264 57.856 8.704 1.536-0.512 2.56-2.56 2.048-4.608-1.536-9.728-8.192-36.864-35.328-54.784z m-68.096-157.696c-1.024-1.024-3.072-1.024-4.608 0-6.144 6.656-22.528 27.136-22.528 64s16.384 57.344 22.528 64c1.024 1.024 3.072 1.024 4.608 0 6.144-6.656 22.528-27.136 22.528-64s-15.872-57.344-22.528-64z m65.536-53.76c-1.536-0.512-3.584 0-4.608 2.048-4.096 8.704-14.336 34.304-4.608 68.608s30.72 48.128 38.4 51.712c1.536 0.512 3.584 0 4.608-2.048 4.096-8.704 14.336-34.304 4.608-68.608-9.216-34.304-30.72-47.616-38.4-51.712z m105.984 123.904c-30.208-7.168-50.688 7.168-57.344 13.312-1.024 1.024-2.048 3.584-1.024 5.632 4.096 8.704 17.408 32.256 48.128 39.424 30.208 7.168 50.688-7.168 57.344-13.312 1.024-1.024 2.048-3.584 1.024-5.632-3.584-8.704-17.408-31.744-48.128-39.424z m-47.616-188.416c-1.536-0.512-3.584 1.024-3.584 3.072-2.048 9.728-5.632 37.376 12.288 67.584 17.92 29.696 41.472 35.84 49.664 36.864 2.048 0.512 3.584-1.024 3.584-3.072 2.048-9.728 5.632-37.376-12.288-67.584-18.432-30.208-41.472-35.84-49.664-36.864z m131.584 81.92c-30.72 3.584-46.592 24.576-51.712 32.768-1.024 2.048-1.024 4.096 0.512 5.632 6.144 6.656 24.576 24.576 55.808 20.992 30.72-3.584 46.592-24.576 51.712-32.768 1.024-2.048 1.024-4.096-0.512-5.632-6.144-6.144-25.088-24.576-55.808-20.992z m99.328-126.464c-7.168-4.096-29.184-15.872-58.368-2.56s-39.424 38.4-41.984 47.616c-0.512 2.048 0 4.096 1.536 5.632 7.168 4.096 29.184 15.872 58.368 2.56 28.672-12.8 39.424-38.4 41.984-47.616 1.024-2.048 0.512-4.608-1.536-5.632z m-123.392 45.056c2.048-0.512 3.072-2.56 3.072-4.096-0.512-9.728-3.072-37.888-27.136-60.928-24.064-23.552-48.128-20.992-55.808-19.456-2.048 0.512-3.072 2.56-3.072 4.096 0.512 9.728 3.072 37.888 27.136 60.928 23.552 23.04 47.616 21.504 55.808 19.456z m26.624-130.048c0 2.56 1.024 3.584 3.072 4.096 8.192 1.024 32.256 2.56 55.296-21.504 23.04-24.064 25.088-52.736 25.088-61.952 0-2.56-1.024-3.584-3.072-4.096-8.192-1.024-32.256-2.56-55.296 21.504-23.04 24.064-25.6 52.736-25.088 61.952z m-19.968 5.12c-3.072-9.216-14.336-34.304-44.032-46.08-29.184-11.264-51.2 0.512-58.368 5.632-1.536 1.024-2.048 3.584-1.536 5.632 3.072 9.216 14.336 34.304 44.032 46.08 29.184 11.264 51.2-0.512 58.368-5.632 1.536-2.048 2.048-4.096 1.536-5.632z m-25.6-108.544c1.024-1.024 1.536-3.584 0.512-5.632-4.096-8.704-18.432-31.232-49.152-37.376-30.208-6.656-50.688 9.728-56.832 15.872-1.024 1.024-1.536 3.584-0.512 5.632 4.608 8.704 18.432 31.232 49.152 37.376 30.208 5.632 50.176-10.24 56.832-15.872z m19.968-14.336c0.512 2.56 2.048 3.584 3.584 3.584 8.192-0.512 31.744-3.584 51.712-31.232 19.968-28.16 18.432-56.832 16.896-66.56-0.512-2.56-2.048-3.584-3.584-3.584-8.192 0.512-31.744 3.584-51.712 31.232-19.968 28.672-17.92 57.344-16.896 66.56z m-45.056-104.96c8.192-2.56 30.208-13.312 43.008-46.592s5.12-60.416 1.536-68.608c-0.512-2.048-2.56-3.072-4.096-2.56-8.192 2.56-30.208 13.312-43.008 46.592-13.312 33.792-5.12 60.416-1.536 68.608 0.512 2.048 2.56 3.072 4.096 2.56zM726.149171 337.92c-1.024 1.024-0.512 3.584 0.512 5.632 6.144 6.656 24.576 24.576 55.808 20.992 20.48-2.048 38.912-13.824 51.712-32.768 1.024-2.048 1.024-4.096-0.512-5.632-6.144-6.656-25.088-24.064-55.808-20.48-30.72 2.56-46.592 24.064-51.712 32.256z m76.8-71.168c2.048-0.512 3.072-2.048 3.072-4.096 3.072-44.032-43.008-94.208-79.36-85.504-2.048 0.512-3.072 2.048-3.072 4.096-3.584 44.032 42.496 93.184 79.36 85.504zM361.093171 784.896c-1.024-1.024-3.072-1.024-4.608 0-6.144 6.656-22.528 27.136-22.528 64s16.384 57.344 22.528 64c1.024 1.024 3.072 1.024 4.608 0 6.144-6.656 22.528-27.136 22.528-64 0.512-36.864-15.872-57.344-22.528-64z m-14.336 148.48c-7.68-3.072-31.232-9.728-57.856 8.704-26.624 18.944-33.792 46.08-35.328 54.784-0.512 2.56 0.512 4.096 2.048 4.608 8.192 3.072 31.232 9.728 57.856-8.704 26.624-17.92 33.792-46.08 35.328-54.784 0.512-1.536-0.512-4.096-2.048-4.608zM185.477171 855.04c-30.208 7.168-44.032 30.72-48.128 39.424-1.024 2.048-0.512 4.096 1.024 5.632 6.656 6.144 26.624 20.48 57.344 13.312 30.208-7.168 44.032-30.72 48.128-39.424 1.024-2.048 0.512-4.096-1.024-5.632-7.168-5.632-27.648-20.48-57.344-13.312z m76.8-1.024c7.68-3.584 28.672-17.408 38.4-51.712 9.728-34.304-0.512-60.416-4.608-68.608-1.024-2.048-2.56-2.56-4.608-2.048-7.68 3.584-28.672 17.408-38.4 51.712-9.728 34.304 0.512 60.416 4.608 68.608 1.024 2.048 2.56 3.072 4.608 2.048z m-87.04-79.872c8.192-1.024 31.744-6.656 49.664-36.864 17.92-29.696 14.336-57.856 12.288-67.584-0.512-2.048-2.048-3.584-3.584-3.072-8.192 1.024-31.744 6.656-49.664 36.864-17.92 29.696-14.336 57.856-12.288 67.584 0 1.536 1.536 3.072 3.584 3.072z m-22.528 7.168c-4.608-7.68-20.992-29.696-51.712-32.768-30.72-3.584-49.664 14.336-55.808 20.992-1.024 1.024-1.536 3.584-0.512 5.632 4.608 7.68 20.992 29.696 51.712 32.768 30.72 3.584 49.664-14.336 55.808-20.992 1.536-1.536 2.048-4.608 0.512-5.632z m56.32-194.56c0-2.56-1.024-3.584-3.072-4.096-8.192-1.024-31.744-3.584-55.808 19.456s-26.624 51.2-27.136 60.928c0 2.56 1.024 3.584 3.072 4.096 8.192 1.024 31.744 3.584 55.808-19.456 24.064-23.552 26.624-51.2 27.136-60.928z m-108.032 86.016c1.536-1.024 2.048-3.584 1.536-5.632-3.072-9.216-13.312-34.304-41.984-47.616-28.672-13.312-50.688-2.048-58.368 2.56-1.536 1.024-2.56 3.584-2.048 5.632 3.072 9.216 13.312 34.304 41.984 47.616 29.696 12.288 51.712 1.536 58.88-2.56z m-5.12-131.072c2.048-0.512 3.072-2.048 3.072-4.096 0-9.728-2.048-37.888-25.088-61.952-23.552-25.088-47.104-24.064-55.296-23.04-2.048 1.024-3.072 2.56-3.072 4.608 0 9.728 2.048 37.888 25.088 61.952 23.04 24.576 47.104 23.552 55.296 22.528z m67.072-45.568c-29.184 11.264-40.448 36.864-44.032 46.08-0.512 2.048 0 4.096 1.536 5.632 7.168 4.608 28.672 16.896 58.368 5.632 29.184-11.264 40.448-36.864 44.032-46.08 0.512-2.048 0-4.096-1.536-5.632-7.168-5.12-29.184-16.896-58.368-5.632z m87.04-89.6c-6.144-6.144-26.112-21.504-56.832-15.872-30.208 6.656-44.544 29.184-49.152 37.376-1.024 2.048-0.512 4.096 0.512 5.632 6.144 6.144 26.112 21.504 56.832 15.872 30.208-6.656 44.544-29.184 49.152-37.376 1.024-2.048 0.512-4.608-0.512-5.632z m-129.024 16.896c2.048 0 3.072-1.024 3.584-3.584 1.536-9.728 3.072-37.888-16.384-66.56-19.968-27.648-44.032-31.232-52.224-31.232-2.048 0-3.072 1.024-3.584 3.584-1.024 9.728-3.072 38.4 16.896 66.56 19.456 27.136 43.52 31.232 51.712 31.232z m48.64-109.056c1.536 0.512 3.584-0.512 4.096-2.56 3.584-9.216 11.264-35.84-1.536-68.608s-35.328-43.52-43.008-46.592c-1.536-0.512-3.584 0.512-4.096 2.56-3.072 9.216-11.264 35.84 2.048 69.632 12.288 32.256 34.816 42.496 42.496 45.568z m72.192 50.176c30.72 3.584 49.664-14.336 55.808-20.48 1.024-1.024 1.536-3.584 0.512-5.632-4.608-7.68-20.48-29.696-51.712-32.768-30.72-3.584-49.664 14.336-55.808 20.48-1.024 1.024-1.536 3.584-0.512 5.632 5.12 8.192 20.992 29.184 51.712 32.768z m-20.48-97.792c36.352 7.68 82.944-41.472 79.36-85.504 0-2.56-1.024-3.584-3.072-4.096C261.253171 168.96 215.173171 218.624 218.245171 262.656c0 2.048 1.536 3.584 3.072 4.096zM510.597171 875.52l21.504 43.52 48.128 6.656-34.816 33.792 8.192 48.128-43.008-22.528-42.496 22.528 8.192-48.128-34.816-33.792 48.128-6.656z" p-id="10272" fill="#cdcdcd"></path><path d="M402.565171 400.896c-4.608 15.36-9.728 33.28-14.336 44.544l-12.288-3.584V450.56H394.373171v21.504h-18.432v2.048l0.512-0.512c4.608 5.12 21.504 28.16 25.6 33.792l-14.848 17.92c-2.56-6.144-6.656-15.36-11.264-24.064v65.536h-20.48v-56.32c-5.12 13.824-10.752 26.624-16.896 35.84-2.048-7.168-7.168-17.408-10.752-24.064 9.216-11.776 18.432-32.768 24.576-50.176h-20.992V450.56h24.576V387.072h20.48v49.152c3.072-11.776 6.656-27.648 8.192-39.424l17.92 4.096z m-56.832-2.56c5.12 13.824 8.704 31.744 9.728 43.52l-15.872 4.096c-0.512-11.776-4.096-30.208-8.704-44.032l14.848-3.584z m118.272-11.776v13.824h40.96v16.384h-40.96v7.68h36.864v15.36h-36.864v8.704h46.08v16.384H399.493171v-16.384h43.008v-8.704H409.733171v-15.36h32.768v-7.68H404.613171v-16.384h37.376v-13.824h22.016z m35.328 86.528v73.728c0 9.216-2.048 14.848-8.704 17.408-6.656 3.072-15.872 3.072-28.16 3.072-1.024-5.632-3.584-13.312-6.144-18.432 7.168 0.512 15.36 0.512 17.92 0 2.56 0 3.072-1.024 3.072-3.072V537.6h-46.592v29.184H409.733171V473.088h89.6z m-68.608 16.384v9.216h46.592v-9.216h-46.592z m0 33.28h46.592v-9.216h-46.592v9.216zM568.965171 525.312c5.12 1.024 9.728 5.632 18.432 10.752 12.288 7.168 28.672 8.704 48.64 8.704 19.456 0 49.152-1.536 67.584-4.608-2.56 6.144-6.144 17.92-6.144 24.064-14.336 1.024-43.52 2.048-61.952 2.048-22.528 0-37.888-2.56-51.2-9.728-7.68-4.608-13.824-10.24-17.92-10.24-7.168 0-17.92 11.264-28.16 23.04l-15.36-19.968c7.68-7.168 16.384-13.312 24.064-17.408v-49.664h-21.504V460.8h43.52v64.512zM542.853171 391.68c10.752 8.704 24.064 21.504 30.208 30.72l-18.944 14.336c-5.632-9.216-18.432-22.528-28.672-32.256l17.408-12.8z m76.8 5.12c-1.024 4.608-2.56 9.216-4.608 13.312h14.848v-23.04h23.04v23.04h40.448V430.08h-40.448v22.528h48.128v19.968h-33.28v33.792c0 5.632 0 6.144 3.584 6.144h8.192c3.072 0 4.096-2.56 4.608-19.968 4.096 3.584 13.824 7.168 19.968 8.704-2.56 25.6-8.192 32.256-22.016 32.256h-14.848c-18.432 0-22.528-6.656-22.528-27.136v-33.792h-12.288c-4.096 27.136-12.8 48.64-45.056 62.464-2.56-5.632-8.704-14.848-13.824-18.944 26.112-9.216 32.768-24.576 35.84-43.52h-31.744v-19.968h52.736V430.08h-24.064c-4.096 7.168-8.192 13.824-12.8 18.944-4.096-3.584-13.824-9.728-18.944-12.288 10.24-10.752 18.432-27.648 23.04-44.032l22.016 4.096z" p-id="10273" fill="#cdcdcd"></path></svg>
      </div>
  </div>
  </div>

</template>

<style scoped lang="scss">
@import "@/style/common.scss";
.course-wrap {
  display: flex;
  justify-content: center;
}
.course-list {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
}
.course-card {
  width: 260px;
  height: 200px;
  cursor: pointer;
  border-radius: 8px;
  background-color: #fff;
  position: relative;
  &-bg{
    position: absolute;
    top: 5px;
    right: 6px;
    width: 62px;
    height: 60px;
  }
  &:hover {
    box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.12);
  }
  .course-cover {
    width: 260px;
    height: 160px;
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
    overflow: hidden;
  }
  .course-name {
    font-weight: 500;
    margin-bottom: 8px;
  }
  .course-text-info {
    padding: 8px;
  }
  .course-info {
    display: flex;
    justify-content: space-between;
    margin-top: 12px;
    &-left {
      color: $active-color;
      font-size: 12px;
    }
    &-right {
      color: $text-plain-color;
      font-size: 12px;
    }
    &-item{
      color:$text-plain-color;
    }
  }
}
</style>
